(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-633598c8"],{"3b2b":function(t,e,i){var a=i("7726"),o=i("5dbc"),n=i("86cc").f,s=i("9093").f,r=i("aae3"),c=i("0bfb"),l=a.RegExp,d=l,u=l.prototype,h=/a/g,f=/a/g,p=new l(h)!==h;if(i("9e1e")&&(!p||i("79e5")(function(){return f[i("2b4c")("match")]=!1,l(h)!=h||l(f)==f||"/a/i"!=l(h,"i")}))){l=function(t,e){var i=this instanceof l,a=r(t),n=void 0===e;return!i&&a&&t.constructor===l&&n?t:o(p?new d(a&&!n?t.source:t,e):d((a=t instanceof l)?t.source:t,a&&n?c.call(t):e),i?this:u,l)};for(var v=function(t){t in l||n(l,t,{configurable:!0,get:function(){return d[t]},set:function(e){d[t]=e}})},b=s(d),g=0;b.length>g;)v(b[g++]);u.constructor=l,l.prototype=u,i("2aba")(a,"RegExp",l)}i("7a56")("RegExp")},"3f24":function(t,e,i){"use strict";var a=i("b0f6"),o=i.n(a);o.a},5147:function(t,e,i){var a=i("2b4c")("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(i){try{return e[a]=!1,!"/./"[t](e)}catch(o){}}return!0}},"5bab":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"book-detail"},[i("detail-title",{ref:"title",attrs:{showShelf:!0},on:{back:t.back}}),i("scroll",{ref:"scroll",staticClass:"content-wrapper",attrs:{top:42,bottom:52},on:{onScroll:t.onScroll}},[i("book-info",{attrs:{cover:t.cover,title:t.title,author:t.author,desc:t.desc}}),i("div",{staticClass:"book-detail-content-wrapper"},[i("div",{staticClass:"book-detail-content-title"},[t._v(t._s(t.$t("detail.copyright")))]),i("div",{staticClass:"book-detail-content-list-wrapper"},[i("div",{staticClass:"book-detail-content-row"},[i("div",{staticClass:"book-detail-content-label"},[t._v(t._s(t.$t("detail.publisher")))]),i("div",{staticClass:"book-detail-content-text"},[t._v(t._s(t.publisher))])]),i("div",{staticClass:"book-detail-content-row"},[i("div",{staticClass:"book-detail-content-label"},[t._v(t._s(t.$t("detail.category")))]),i("div",{staticClass:"book-detail-content-text"},[t._v(t._s(t.categoryText))])]),i("div",{staticClass:"book-detail-content-row"},[i("div",{staticClass:"book-detail-content-label"},[t._v(t._s(t.$t("detail.lang")))]),i("div",{staticClass:"book-detail-content-text"},[t._v(t._s(t.lang))])]),i("div",{staticClass:"book-detail-content-row"},[i("div",{staticClass:"book-detail-content-label"},[t._v(t._s(t.$t("detail.ISBN")))]),i("div",{staticClass:"book-detail-content-text"},[t._v(t._s(t.isbn))])])])]),i("div",{staticClass:"book-detail-content-wrapper"},[i("div",{staticClass:"book-detail-content-title"},[t._v(t._s(t.$t("detail.navigation")))]),i("div",{staticClass:"book-detail-content-list-wrapper"},[this.navigation?t._e():i("div",{staticClass:"loading-text-wrapper"},[i("span",{staticClass:"loading-text"},[t._v(t._s(t.$t("detail.loading")))])]),i("div",{staticClass:"book-detail-content-item-wrapper"},t._l(t.flatNavigation,function(e,a){return i("div",{key:a,staticClass:"book-detail-content-item",on:{click:function(i){return t.read(e)}}},[e.label?i("div",{staticClass:"book-detail-content-navigation-text",class:{"is-sub":e.deep>1},style:t.itemStyle(e)},[t._v(t._s(e.label)+"\n            ")]):t._e()])}),0)])]),i("div",{staticClass:"book-detail-content-wrapper"},[i("div",{staticClass:"book-detail-content-title"},[t._v(t._s(t.$t("detail.trial")))]),i("div",{staticClass:"book-detail-content-list-wrapper"},[this.displayed?t._e():i("div",{staticClass:"loading-text-wrapper"},[i("span",{staticClass:"loading-text"},[t._v(t._s(t.$t("detail.loading")))])])]),i("div",{directives:[{name:"show",rawName:"v-show",value:this.displayed,expression:"this.displayed"}],ref:"preview",attrs:{id:"preview"}})])],1),i("div",{staticClass:"bottom-wrapper"},[i("div",{staticClass:"bottom-btn",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.readBook()}}},[t._v(t._s(t.$t("detail.read")))]),i("div",{staticClass:"bottom-btn",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.trialListening()}}},[t._v(t._s(t.$t("detail.listen")))]),i("div",{staticClass:"bottom-btn",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.addOrRemoveShelf()}}},[t.inBookShelf?i("span",{staticClass:"icon-check"}):t._e(),t._v("\n      "+t._s(t.inBookShelf?t.$t("detail.isAddedToShelf"):t.$t("detail.addOrRemoveShelf"))+"\n    ")])]),i("toast",{ref:"toast",attrs:{text:t.toastText}})],1)},o=[],n=i("70e8"),s=n["a"],r=(i("3f24"),i("2877")),c=Object(r["a"])(s,a,o,!1,null,"6637d9ee",null);e["default"]=c.exports},"70e8":function(t,e,i){"use strict";(function(t){i("f559"),i("a481"),i("3b2b"),i("ac6a");var a=i("75fc"),o=i("1432"),n=i("c470"),s=i("6701"),r=i("78dc"),c=i("73f5"),l=i("ac0d"),d=i("fa7d"),u=i("101f"),h=i("a211"),f=i("da6f"),p=i("e8ec");t.ePub=h["a"],e["a"]={mixins:[l["c"]],components:{DetailTitle:o["a"],Scroll:s["a"],BookInfo:n["a"],Toast:r["a"]},computed:{desc:function(){return this.description?this.description.substring(0,100):""},flatNavigation:function(){return this.navigation?Array.prototype.concat.apply([],Array.prototype.concat.apply([],this.doFlatNavigation(this.navigation.toc))):[]},lang:function(){return this.metadata?this.metadata.language:"-"},isbn:function(){return this.metadata?this.metadata.identifier:"-"},publisher:function(){return this.metadata?this.metadata.publisher:"-"},title:function(){return this.metadata?this.metadata.title:""},author:function(){return this.metadata?this.metadata.creator:""},inBookShelf:function(){var t=this;if(this.bookItem&&this.shelfList){var e=function t(e){var i;return(i=[]).concat.apply(i,Object(a["a"])(e.map(function(e){return e.itemList?[e].concat(Object(a["a"])(t(e.itemList))):e})))}(this.shelfList).filter(function(t){return 1===t.type}),i=e.filter(function(e){return e.fileName===t.bookItem.fileName});return i&&i.length>0}return!1}},data:function(){return{bookItem:null,book:null,metadata:null,trialRead:null,cover:null,navigation:null,displayed:!1,audio:null,randomLocation:null,description:null,toastText:"",trialText:null,categoryText:null,opf:null}},methods:{addOrRemoveShelf:function(){var t=this;this.inBookShelf?this.setShelfList(Object(f["l"])(this.bookItem)).then(function(){Object(p["l"])(t.shelfList)}):(Object(f["a"])(this.bookItem),this.setShelfList(Object(p["b"])()))},showToast:function(t){this.toastText=t,this.$refs.toast.show()},readBook:function(){this.$router.push({path:"/ebook/".concat(this.categoryText,"|").concat(this.fileName)})},trialListening:function(){var t=this;Object(u["b"])(this.bookItem.fileName,function(e,i){!e&&i&&i instanceof Blob?t.$router.push({path:"/store/speaking",query:{fileName:t.bookItem.fileName}}):t.$router.push({path:"/store/speaking",query:{fileName:t.bookItem.fileName,opf:t.opf}})})},read:function(t){this.$router.push({path:"/ebook/".concat(this.categoryText,"|").concat(this.fileName)})},itemStyle:function(t){return{marginLeft:(t.deep-1)*Object(d["a"])(20)+"rem"}},doFlatNavigation:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=[];return t.forEach(function(t){t.deep=i,a.push(t),t.subitems&&t.subitems.length>0&&a.push(e.doFlatNavigation(t.subitems,i+1))}),a},downloadBook:function(){var t="".concat("http://47.99.166.157/epub","/").concat(this.bookItem.categoryText,"/").concat(this.bookItem.fileName,"/OEBPS/package.opf");this.parseBook(t)},parseBook:function(t){var e=this;this.book=new h["a"](t),this.book.loaded.metadata.then(function(t){e.metadata=t}),this.book.loaded.navigation.then(function(t){if(e.navigation=t,e.navigation.toc&&e.navigation.toc.length>1){var i=e.display(e.navigation.toc[1].href);i&&i.then(function(t){e.$refs.scroll&&e.$refs.scroll.refresh(),e.displayed=!0;var i=new RegExp("<.+?>","g"),a=t.output.replace(i,"").replace(/\s\s/g,"");e.description=a})}})},init:function(){var t=this;this.fileName=this.$route.query.fileName,this.categoryText=this.$route.query.category,this.fileName&&Object(c["a"])({fileName:this.fileName}).then(function(e){if(200===e.status&&0===e.data.error_code&&e.data.data){var i=e.data.data;t.bookItem=i,t.cover=t.bookItem.cover;var a=i.rootFile;a.startsWith("/")&&(a=a.substring(1,a.length)),t.opf="".concat("http://47.99.166.157/epub2","/").concat(t.fileName,"/").concat(a),t.parseBook(t.opf)}else t.showToast(e.data.msg)})},back:function(){this.$router.go(-1)},display:function(t){if(this.$refs.preview)return this.rendition||(this.rendition=this.book.renderTo("preview",{width:window.innerWidth>640?640:window.innerWidth,height:window.innerHeight,method:"default"})),t?this.rendition.display(t):this.rendition.display()},onScroll:function(t){t>Object(d["b"])(42)?this.$refs.title.showShadow():this.$refs.title.hideShadow()}},mounted:function(){this.init(),this.shelfList&&0!==this.shelfList.length||this.getShelfList()}}}).call(this,i("c8ba"))},aae3:function(t,e,i){var a=i("d3f4"),o=i("2d95"),n=i("2b4c")("match");t.exports=function(t){var e;return a(t)&&(void 0!==(e=t[n])?!!e:"RegExp"==o(t))}},b0f6:function(t,e,i){},d2c8:function(t,e,i){var a=i("aae3"),o=i("be13");t.exports=function(t,e,i){if(a(e))throw TypeError("String#"+i+" doesn't accept regex!");return String(o(t))}},f559:function(t,e,i){"use strict";var a=i("5ca1"),o=i("9def"),n=i("d2c8"),s="startsWith",r=""[s];a(a.P+a.F*i("5147")(s),"String",{startsWith:function(t){var e=n(this,t,s),i=o(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),a=String(t);return r?r.call(e,a,i):e.slice(i,i+a.length)===a}})}}]);
//# sourceMappingURL=chunk-633598c8.4d7ce728.js.map